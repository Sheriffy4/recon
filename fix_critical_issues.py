#!/usr/bin/env python3
"""
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º zapret —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
"""
import sys
import os

# Add recon directory to path
recon_dir = os.path.dirname(os.path.abspath(__file__))
if recon_dir not in sys.path:
    sys.path.insert(0, recon_dir)

def analyze_critical_issues():
    """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã."""
    print("üö® –ê–ù–ê–õ–ò–ó –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –ü–†–û–ë–õ–ï–ú")
    print("=" * 50)
    
    print("‚ùå –ü–†–û–ë–õ–ï–ú–ê 1: Checksum –Ω–µ –ø–æ—Ä—Ç–∏—Ç—Å—è –≤ PCAP")
    print("   –ö–æ–¥ –ø–æ—Ä—Ç–∏—Ç: good=d830, bad=27cf")
    print("   PCAP –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: csum_fake_bad=false")
    print("   –ü—Ä–∏—á–∏–Ω–∞: pydivert –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç checksum –ø–æ—Å–ª–µ –Ω–∞—à–µ–≥–æ –∫–æ–¥–∞")
    print("   –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å raw sockets –∏–ª–∏ –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥")
    
    print("\n‚ùå –ü–†–û–ë–õ–ï–ú–ê 2: –ú–µ–¥–ª–µ–Ω–Ω—ã–π timing")
    print("   –¢–µ–∫—É—â–∏–π: 1.99ms")
    print("   Zapret: <0.1ms")
    print("   –†–∞–∑–Ω–∏—Ü–∞: –≤ 20 —Ä–∞–∑ –º–µ–¥–ª–µ–Ω–Ω–µ–µ")
    print("   –†–µ—à–µ–Ω–∏–µ: –ù–∞–π—Ç–∏ —Å–∫—Ä—ã—Ç—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏")
    
    print("\nüö® –ü–†–û–ë–õ–ï–ú–ê 3: 0 –î–û–ú–ï–ù–û–í –û–¢–ö–†–´–¢–û (–ì–õ–ê–í–ù–ê–Ø!)")
    print("   –†–µ–∑—É–ª—å—Ç–∞—Ç: 0/26 —Å–∞–π—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç")
    print("   RST –ø–∞–∫–µ—Ç—ã: 4 (DPI –±–ª–æ–∫–∏—Ä—É–µ—Ç)")
    print("   –ü—Ä–∏—á–∏–Ω–∞: –û–±—Ö–æ–¥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º 1-2")
    print("   –†–µ—à–µ–Ω–∏–µ: –ò—Å–ø—Ä–∞–≤–∏—Ç—å checksum –∏ timing")

def suggest_checksum_fix():
    """–ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ checksum."""
    print("\nüîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï CHECKSUM:")
    print("1. –ü—Ä–æ–±–ª–µ–º–∞: pydivert.send() –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç checksum")
    print("2. –†–µ—à–µ–Ω–∏—è:")
    print("   a) –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å raw sockets –≤–º–µ—Å—Ç–æ pydivert")
    print("   b) –ù–∞–π—Ç–∏ —Ñ–ª–∞–≥ pydivert –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞")
    print("   c) –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —á–µ—Ä–µ–∑ WinDivert –Ω–∞–ø—Ä—è–º—É—é")
    print("   d) –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å scapy –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏")
    
    print("\nüí° –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–û–ï –†–ï–®–ï–ù–ò–ï:")
    print("–ó–∞–º–µ–Ω–∏—Ç—å w.send(pkt) –Ω–∞ raw socket –æ—Ç–ø—Ä–∞–≤–∫—É")
    print("–∏–ª–∏ –Ω–∞–π—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä pydivert –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è checksum")

def suggest_timing_fix():
    """–ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ timing."""
    print("\n‚ö° –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï TIMING:")
    print("1. –¢–µ–∫—É—â–∏–π timing: 1.99ms")
    print("2. –¶–µ–ª—å: <0.1ms (–∫–∞–∫ –≤ zapret)")
    print("3. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∑–∞–¥–µ—Ä–∂–µ–∫:")
    print("   - –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤")
    print("   - –í—ã–∑–æ–≤—ã pydivert")
    print("   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ")
    print("   - –°–∫—Ä—ã—Ç—ã–µ time.sleep()")
    
    print("\nüí° –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ï –î–ï–ô–°–¢–í–ò–Ø:")
    print("1. –£–±—Ä–∞—Ç—å –≤—Å–µ –ª–æ–≥–∏ –∏–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—É—Ç–∏")
    print("2. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø–∞–∫–µ—Ç—ã")
    print("3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å batch –æ—Ç–ø—Ä–∞–≤–∫—É")
    print("4. –ù–∞–π—Ç–∏ –≤—Å–µ time.sleep() –≤ –∫–æ–¥–µ")

def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è."""
    analyze_critical_issues()
    suggest_checksum_fix()
    suggest_timing_fix()
    
    print("\n" + "=" * 50)
    print("üéØ –ü–†–ò–û–†–ò–¢–ï–¢–´:")
    print("1. –ö–†–ò–¢–ò–ß–ù–û: –ò—Å–ø—Ä–∞–≤–∏—Ç—å checksum (–±–µ–∑ —ç—Ç–æ–≥–æ –æ–±—Ö–æ–¥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)")
    print("2. –í–ê–ñ–ù–û: –ò—Å–ø—Ä–∞–≤–∏—Ç—å timing (–¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏)")
    print("3. –†–ï–ó–£–õ–¨–¢–ê–¢: –î–æ–º–µ–Ω—ã –¥–æ–ª–∂–Ω—ã –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è")
    
    print("\nüöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:")
    print("1. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å pydivert –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è checksum")
    print("2. –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å raw sockets")
    print("3. –£–±—Ä–∞—Ç—å –≤—Å–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –∏–∑ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—É—Ç–∏")
    print("4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–æ–º–µ–Ω–∞—Ö")

if __name__ == "__main__":
    main()