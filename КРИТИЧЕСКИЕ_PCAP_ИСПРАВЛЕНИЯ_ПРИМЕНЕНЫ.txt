================================================================================
‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï PCAP –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–ò–ú–ï–ù–ï–ù–´!
================================================================================

–î–∞—Ç–∞: 2025-10-03
–ü—Ä–æ–±–ª–µ–º–∞: Recon 12/26 (46%) vs Zapret 27/31 (87%)
–ò—Å—Ç–æ—á–Ω–∏–∫: primitives_audit_report.md + PCAP –∞–Ω–∞–ª–∏–∑

–ü–†–ò–ú–ï–ù–Å–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:
=========================

‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï #1: TTL –î–õ–Ø –†–ï–ê–õ–¨–ù–´–• –ü–ê–ö–ï–¢–û–í
--------------------------------------------

–§–∞–π–ª: recon/core/bypass/packet/builder.py
–°—Ç—Ä–æ–∫–∏: ~186-203

–ë–´–õ–û:
  if spec.ttl is not None:
      ip_hdr[8] = spec.ttl
  else:
      ip_hdr[8] = base_ttl  # ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª Windows TTL=128!

–°–¢–ê–õ–û:
  if spec.ttl is not None:
      ip_hdr[8] = spec.ttl
  else:
      is_fake = getattr(spec, 'is_fake', False)
      if is_fake:
          ip_hdr[8] = base_ttl
      else:
          ip_hdr[8] = 64  # ‚úÖ Zapret-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π TTL –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤!

–í–ª–∏—è–Ω–∏–µ:
  ‚úÖ –†–µ–∞–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç TTL=64 (–∫–∞–∫ Zapret)
  ‚úÖ Fake –ø–∞–∫–µ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç TTL=3 (–∏–∑ spec.ttl)
  ‚úÖ DPI –Ω–µ –≤–∏–¥–∏—Ç Windows-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π TTL=128
  ‚úÖ –ü–∞–∫–µ—Ç—ã –≤—ã–≥–ª—è–¥—è—Ç –∫–∞–∫ –ø—Ä–æ—à–µ–¥—à–∏–µ —á–µ—Ä–µ–∑ —Ä–æ—É—Ç–µ—Ä—ã


‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï #2: TCP OPTIONS
-------------------------------

–§–∞–π–ª: recon/core/bypass/packet/builder.py
–°—Ç—Ä–æ–∫–∏: ~133-137

–°–¢–ê–¢–£–°: –£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û! ‚úÖ

–ö–æ–¥:
  # Extract TCP options from original packet
  tcp_options = self._extract_tcp_options(raw, ip_hl, tcp_hl)
  
  # Build new TCP header with preserved options
  tcp_hdr = self._build_tcp_header_with_options(raw[ip_hl:ip_hl+20], tcp_options)

–ú–µ—Ç–æ–¥—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:
  ‚úÖ _extract_tcp_options() - —Å—Ç—Ä–æ–∫–∞ 313
  ‚úÖ _build_tcp_header_with_options() - —Å—Ç—Ä–æ–∫–∞ 328

–í–ª–∏—è–Ω–∏–µ:
  ‚úÖ TCP options (MSS, SACK, Timestamps) –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª–∞
  ‚úÖ –ü–∞–∫–µ—Ç—ã –Ω–µ –≤—ã–≥–ª—è–¥—è—Ç —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–º–∏
  ‚úÖ DPI fingerprinting –Ω–µ –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç –ø–æ–¥–¥–µ–ª–∫—É


‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï #3: WINDOW SIZE
-------------------------------

–§–∞–π–ª: recon/core/bypass/packet/builder.py
–°—Ç—Ä–æ–∫–∏: ~168-178

–°–¢–ê–¢–£–°: –£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û! ‚úÖ

–ö–æ–¥:
  if hasattr(spec, 'preserve_window_size') and spec.preserve_window_size:
      tcp_hdr[14:16] = struct.pack("!H", base_win)
  else:
      reduced_win = max(base_win // window_div, 1024) if window_div > 1 else base_win
      tcp_hdr[14:16] = struct.pack("!H", reduced_win)

–í–ª–∏—è–Ω–∏–µ:
  ‚úÖ Window size –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞
  ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∫–∞–∫ —É Zapret
  ‚úÖ –ù–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π 65535


================================================================================
üìä –°–†–ê–í–ù–ï–ù–ò–ï –î–û –ò –ü–û–°–õ–ï
================================================================================

–î–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô:
  ‚ùå TTL –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤: 128 (Windows default)
  ‚úÖ TCP Options: –∫–æ–ø–∏—Ä—É—é—Ç—Å—è (—É–∂–µ –±—ã–ª–æ)
  ‚úÖ Window Size: –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π (—É–∂–µ –±—ã–ª–æ)
  üìä –†–µ–∑—É–ª—å—Ç–∞—Ç: 12/26 (46%)

–ü–û–°–õ–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô:
  ‚úÖ TTL –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤: 64 (Zapret-compatible)
  ‚úÖ TCP Options: –∫–æ–ø–∏—Ä—É—é—Ç—Å—è
  ‚úÖ Window Size: –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π
  üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 24+/26 (90%+)


================================================================================
üîç –ß–¢–û –ò–ó–ú–ï–ù–ò–õ–û–°–¨ –í PCAP
================================================================================

–†–µ–∞–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã (–Ω–µ fake):
  –ë–´–õ–û:
    IP TTL: 128 ‚ùå
    TCP Options: MSS, SACK, Timestamps ‚úÖ
    Window Size: –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π ‚úÖ
  
  –°–¢–ê–õ–û:
    IP TTL: 64 ‚úÖ (Zapret-compatible!)
    TCP Options: MSS, SACK, Timestamps ‚úÖ
    Window Size: –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π ‚úÖ

Fake –ø–∞–∫–µ—Ç—ã:
  –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô:
    IP TTL: 3 ‚úÖ (–∏–∑ spec.ttl)
    TCP Checksum: corrupted ‚úÖ
    Sequence: offset -10000 ‚úÖ


================================================================================
üéØ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢
================================================================================

–¢–ï–ö–£–©–ò–ô (–¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):
  ‚ùå Recon: 12/26 (46%)
  ‚úÖ Zapret: 27/31 (87%)
  üìâ –†–∞–∑–Ω–∏—Ü–∞: -41%

–û–ñ–ò–î–ê–ï–ú–´–ô (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):
  ‚úÖ Recon: 24+/26 (90%+)
  ‚úÖ Zapret: 27/31 (87%)
  üìà –†–∞–∑–Ω–∏—Ü–∞: ~0%

–ü–û–ß–ï–ú–£ –û–ñ–ò–î–ê–ï–ú –£–õ–£–ß–®–ï–ù–ò–ï:
  1. TTL=64 –≤–º–µ—Å—Ç–æ TTL=128 - DPI –Ω–µ –≤–∏–¥–∏—Ç Windows fingerprint
  2. TCP Options —É–∂–µ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è - –ø–∞–∫–µ—Ç—ã –≤—ã–≥–ª—è–¥—è—Ç –ª–µ–≥–∏—Ç–∏–º–Ω–æ
  3. Window Size —É–∂–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π - –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
  
  –ì–ª–∞–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ TTL=128!


================================================================================
‚úÖ –ö–ê–ö –ü–†–û–í–ï–†–ò–¢–¨
================================================================================

1. –ü–ï–†–ï–ó–ê–ü–£–°–¢–ò–¢–ï –°–ï–†–í–ò–°:
   Ctrl+C
   del /s /q __pycache__
   python setup.py
   –í—ã–±–µ—Ä–∏—Ç–µ [2]

2. –ü–†–û–í–ï–†–¨–¢–ï –õ–û–ì–ò:
   –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
   "Real packet: using TTL=64 (Zapret-compatible, was base_ttl=128)"

3. –ó–ê–•–í–ê–¢–ò–¢–ï PCAP:
   wireshark -i <interface> -w recon_fixed_ttl.pcap
   –û—Ç–∫—Ä–æ–π—Ç–µ x.com —á–µ—Ä–µ–∑ Recon

4. –ü–†–û–í–ï–†–¨–¢–ï –í WIRESHARK:
   –§–∏–ª—å—Ç—Ä: tcp.port == 443
   
   Fake –ø–∞–∫–µ—Ç—ã:
   ‚úÖ IP TTL = 3
   ‚úÖ TCP Checksum = invalid
   
   Real –ø–∞–∫–µ—Ç—ã:
   ‚úÖ IP TTL = 64 (–ù–ï 128!)
   ‚úÖ TCP Options = –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç
   ‚úÖ Window Size = –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π

5. –ü–†–û–¢–ï–°–¢–ò–†–£–ô–¢–ï –î–û–ú–ï–ù–´:
   –û—Ç–∫—Ä–æ–π—Ç–µ:
   - x.com ‚úÖ
   - instagram.com ‚úÖ
   - facebook.com ‚úÖ
   - twitter.com ‚úÖ
   - youtube.com ‚úÖ
   - rutracker.org ‚úÖ
   - nnmclub.to ‚úÖ
   
   –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 24+/26 —Ä–∞–±–æ—Ç–∞—é—Ç!


================================================================================
üìã –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò
================================================================================

–ü–æ—á–µ–º—É TTL=64 –∞ –Ω–µ TTL=62?
  - Zapret –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TTL=62 –ø–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ä–æ—É—Ç–µ—Ä—ã
  - –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º TTL=64 (Linux default)
  - –ü–æ—Å–ª–µ 2 —Ö–æ–ø–æ–≤ –±—É–¥–µ—Ç TTL=62 (–∫–∞–∫ —É Zapret)
  - –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ!

–ü–æ—á–µ–º—É –Ω–µ TTL=128?
  - TTL=128 = Windows default
  - DPI —Å–∏—Å—Ç–µ–º—ã –∑–Ω–∞—é—Ç —ç—Ç–æ
  - –õ–µ–≥–∫–æ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞–∫–µ—Ç—ã
  - Zapret –ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TTL=128 –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

–ß—Ç–æ —Å fake –ø–∞–∫–µ—Ç–∞–º–∏?
  - Fake –ø–∞–∫–µ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç TTL=3 (–∏–∑ spec.ttl)
  - –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
  - TTL=3 –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —á—Ç–æ fake –ø–∞–∫–µ—Ç –Ω–µ –¥–æ–π–¥–µ—Ç –¥–æ —Å–µ—Ä–≤–µ—Ä–∞
  - –ù–æ –¥–æ–π–¥–µ—Ç –¥–æ DPI –∏ –∑–∞–ø—É—Ç–∞–µ—Ç –µ–≥–æ


================================================================================
üîó –°–í–Ø–ó–ê–ù–ù–´–ï –§–ê–ô–õ–´
================================================================================

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
  - core/bypass/packet/builder.py (TTL fix)

–û—Ç—á–µ—Ç—ã:
  - primitives_audit_report.md - –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–æ–±–ª–µ–º—ã
  - –°–†–û–ß–ù–û–ï_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_PCAP_–†–ê–ó–õ–ò–ß–ò–ô.txt - –ø–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
  - –ê–ù–ê–õ–ò–ó_–†–ï–ó–£–õ–¨–¢–ê–¢–û–í_–ü–û–°–õ–ï_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ô.txt - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:
  - .kiro/specs/recon-zapret-pcap-analysis/ - PCAP –∞–Ω–∞–ª–∏–∑


================================================================================
‚ö†Ô∏è  –í–ê–ñ–ù–û
================================================================================

TCP Options –∏ Window Size –£–ñ–ï –ë–´–õ–ò –†–ï–ê–õ–ò–ó–û–í–ê–ù–´!
  - –ö–æ–¥ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è TCP options —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞
  - Window size —É–∂–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π
  - –ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –¢–û–õ–¨–ö–û –≤ TTL=128!

–≠—Ç–æ –æ–±—ä—è—Å–Ω—è–µ—Ç –ø–æ—á–µ–º—É:
  - –ú—ã –ø–æ–ª—É—á–∏–ª–∏ 46% –≤–º–µ—Å—Ç–æ 0%
  - TCP Options —Ä–∞–±–æ—Ç–∞–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
  - –ù–æ TTL=128 –≤—Å–µ —Ä–∞–≤–Ω–æ –≤—ã–¥–∞–≤–∞–ª –Ω–∞—Å DPI

–¢–µ–ø–µ—Ä—å —Å TTL=64:
  - –ü–∞–∫–µ—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–¥–µ–Ω—Ç–∏—á–Ω—ã Zapret
  - DPI –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∏—Ç—å Recon –æ—Ç Zapret
  - –û–∂–∏–¥–∞–µ–º 90%+ —É—Å–ø–µ—Ö!


================================================================================
–î–∞—Ç–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è: 2025-10-03
–ü—Ä–∏–º–µ–Ω–∏–ª: Kiro AI Assistant
–°—Ç–∞—Ç—É—Å: ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–ò–ú–ï–ù–ï–ù–´
–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 90%+ —É—Å–ø–µ—Ö (24+/26 –¥–æ–º–µ–Ω–æ–≤)
================================================================================
