# –£–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –¥–æ–º–µ–Ω–æ–≤

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–æ–º–µ–Ω—ã (—Ç–∞–∫–∏–µ –∫–∞–∫ x.com, instagram.com) –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –æ–±—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ DoH (DNS over HTTPS) –∏ –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîç **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫** - —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–æ–º–µ–Ω—ã –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–∏–ø –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- üåê **DoH –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç DNS over HTTPS –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö IP –∞–¥—Ä–µ—Å–æ–≤
- üìù **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å hosts —Ñ–∞–π–ª–æ–º** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–∞–ø–∏—Å–∏ –∏–∑ hosts —Ñ–∞–π–ª–∞
- ‚ö° **–£–º–Ω—ã–π –≤—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏** - –≤—ã–±–∏—Ä–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –æ–±—Ö–æ–¥–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–æ–º–µ–Ω–∞
- üìä **–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤
- üîß **CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - —É–¥–æ–±–Ω—ã–π –∫–æ–º–∞–Ω–¥–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```bash
# –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ —Å–∏—Å—Ç–µ–º—ã
python test_smart_bypass.py

# –ê–Ω–∞–ª–∏–∑ PCAP —Ñ–∞–π–ª–∞ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –æ–±—Ö–æ–¥–∞
python analyze_test1_pcap.py
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CLI

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –¥–æ–º–µ–Ω–∞
python smart_bypass_cli.py check x.com

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
python smart_bypass_cli.py test x.com --port 443

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –¥–æ–º–µ–Ω–æ–≤
python smart_bypass_cli.py test-multiple x.com instagram.com facebook.com

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–º–µ–Ω–æ–≤ –∏–∑ —Ñ–∞–π–ª–∞
python smart_bypass_cli.py test-file sites.txt

# –ü–æ–∏—Å–∫ –ª—É—á—à–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
python smart_bypass_cli.py strategies x.com instagram.com

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
python smart_bypass_cli.py report --output bypass_report.json

# –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
python smart_bypass_cli.py stats
```

### 3. –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
import asyncio
from core.smart_bypass_engine import SmartBypassEngine

async def main():
    # –°–æ–∑–¥–∞–Ω–∏–µ –¥–≤–∏–∂–∫–∞
    engine = SmartBypassEngine()
    
    # –ê–Ω–∞–ª–∏–∑ –¥–æ–º–µ–Ω–∞
    status = await engine.analyze_domain('x.com')
    print(f"–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: {status.is_blocked}")
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ IP
    ip, method = await engine.get_optimal_ip('x.com')
    print(f"IP: {ip}, –º–µ—Ç–æ–¥: {method}")
    
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
    result = await engine.test_connection('x.com')
    print(f"–£—Å–ø–µ—Ö: {result.success}")
    
    await engine.cleanup()

asyncio.run(main())
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∞–π–ª `smart_bypass_config.json` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```json
{
  "doh_providers": ["cloudflare", "google", "quad9"],
  "cache_ttl": 300,
  "known_blocked_domains": [
    "x.com", "instagram.com", "facebook.com"
  ],
  "bypass_strategies": {
    "ip_block": ["hosts", "doh"],
    "dns_block": ["doh", "hosts"]
  }
}
```

## –¢–∏–ø—ã –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫

–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Ç–∏–ø—ã –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫:

- **ip_block** - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ IP –∞–¥—Ä–µ—Å—É (–ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –∑–∞–≥–ª—É—à–∫—É)
- **dns_block** - DNS –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (–¥–æ–º–µ–Ω –Ω–µ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è)
- **dns_hijack** - –ø–æ–¥–º–µ–Ω–∞ DNS (–≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ IP)
- **none** - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞

## –ú–µ—Ç–æ–¥—ã –æ–±—Ö–æ–¥–∞

1. **hosts** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π –∏–∑ —Ñ–∞–π–ª–∞ hosts
2. **doh** - DNS over HTTPS (Cloudflare, Google, Quad9)
3. **system_dns** - —Å–∏—Å—Ç–µ–º–Ω—ã–π DNS (–µ—Å–ª–∏ –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω)
4. **direct** - –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ hosts —Ñ–∞–π–ª–∞

–î–ª—è Windows (—Ç—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞):
```
C:\Windows\System32\drivers\etc\hosts
```

–ü—Ä–∏–º–µ—Ä –∑–∞–ø–∏—Å–µ–π:
```
104.244.42.129  x.com
104.244.42.129  www.x.com
157.240.15.174  instagram.com
157.240.15.174  www.instagram.com
```

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è hosts —Ñ–∞–π–ª–∞:
```cmd
ipconfig /flushdns
```

## DoH —Å–µ—Ä–≤–µ—Ä—ã

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ DoH –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã:

- **Cloudflare**: 1.1.1.1, 1.0.0.1
- **Google**: 8.8.8.8, 8.8.4.4  
- **Quad9**: 9.9.9.9, 149.112.112.112
- **AdGuard**: dns.adguard.com

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å x.com
python smart_bypass_cli.py check x.com --verbose

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# –î–æ–º–µ–Ω: x.com
# –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: –î–∞
# –¢–∏–ø –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏: ip_block
# –¢—Ä–µ–±—É–µ—Ç –æ–±—Ö–æ–¥–∞: –î–∞
# –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π IP: 104.244.42.129 (–º–µ—Ç–æ–¥: doh)
```

### –ú–∞—Å—Å–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª sites.txt —Å –¥–æ–º–µ–Ω–∞–º–∏
echo "x.com" > sites.txt
echo "instagram.com" >> sites.txt
echo "google.com" >> sites.txt

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–æ–º–µ–Ω—ã
python smart_bypass_cli.py test-file sites.txt

# –†–µ–∑—É–ª—å—Ç–∞—Ç:
# –î–æ–º–µ–Ω               –°—Ç–∞—Ç—É—Å   –ú–µ—Ç–æ–¥        IP              –ó–∞–¥–µ—Ä–∂–∫–∞
# x.com               ‚úì        doh          104.244.42.129  45.2ms
# instagram.com       ‚úì        hosts        157.240.15.174  32.1ms
# google.com          ‚úì        system_dns   142.250.185.78  12.5ms
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞

```bash
python smart_bypass_cli.py report --output report.json
```

–û—Ç—á–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ–±—Ö–æ–¥–æ–≤
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–∞—Ö
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º—ã

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å zapret

```python
from core.smart_bypass_engine import SmartBypassEngine

async def get_bypass_ip_for_zapret(domain):
    engine = SmartBypassEngine()
    ip, method = await engine.get_optimal_ip(domain)
    await engine.cleanup()
    return ip
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å packet capture

```python
# –í analyze_test1_pcap.py —É–∂–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞
python analyze_test1_pcap.py
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### DoH –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å DoH —Å–µ—Ä–≤–µ—Ä–æ–≤:
```bash
curl -H "accept: application/dns-json" "https://1.1.1.1/dns-query?name=x.com&type=A"
```

2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### Hosts —Ñ–∞–π–ª –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É hosts
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–ø–∏—Å–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. –û—á–∏—Å—Ç–∏—Ç–µ DNS –∫—ç—à: `ipconfig /flushdns`

### –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞

1. –£–≤–µ–ª–∏—á—å—Ç–µ cache_ttl –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2. –£–º–µ–Ω—å—à–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ DoH –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω—ã–π DNS –∫—ç—à

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –≤–µ–¥–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏:

```python
import logging
logging.basicConfig(level=logging.INFO)

# –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ logs/smart_bypass.log
```

–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
- **DEBUG** - –ø–æ–¥—Ä–æ–±–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **INFO** - –æ—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **WARNING** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- **ERROR** - –æ—à–∏–±–∫–∏

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**

1. DoH —Ç—Ä–∞—Ñ–∏–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞ —É—Ä–æ–≤–Ω–µ DPI
2. –ò–∑–º–µ–Ω–µ–Ω–∏–µ hosts —Ñ–∞–π–ª–∞ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
3. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å—ã –º–æ–≥—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è hosts
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ DoH —Å–µ—Ä–≤–µ—Ä—ã

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–°–∏—Å—Ç–µ–º–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è:
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –¥–æ–º–µ–Ω–æ–≤
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è DNS –∑–∞–ø—Ä–æ—Å–æ–≤
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–±–æ—Ä–∞ —Å–∞–º—ã—Ö –±—ã—Å—Ç—Ä—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–º–æ—â–∏:

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É: `python test_smart_bypass.py`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ `logs/smart_bypass.log`
3. –°–æ–∑–¥–∞–π—Ç–µ –æ—Ç—á–µ—Ç: `python smart_bypass_cli.py report`

## –õ–∏—Ü–µ–Ω–∑–∏—è

–°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π –∏ –æ–±—Ö–æ–¥–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.