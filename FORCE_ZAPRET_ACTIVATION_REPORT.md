# üö® –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–ê–Ø –ê–ö–¢–ò–í–ê–¶–ò–Ø ZAPRET-STYLE

## üìä –ü–†–û–ë–õ–ï–ú–ê –û–ë–ù–ê–†–£–ñ–ï–ù–ê
–ê–Ω–∞–ª–∏–∑ —Å–≤–µ–∂–µ–≥–æ out2.pcap –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ **zapret-style –ª–æ–≥–∏–∫–∞ –ù–ï –ê–ö–¢–ò–í–ò–†–£–ï–¢–°–Ø**:

### –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–∫–µ—Ç–æ–≤:
- **Fake –ø–∞–∫–µ—Ç:** TTL=3, flags=16(ACK), checksum=OK, len=76
- **Real –ø–∞–∫–µ—Ç:** TTL=128, flags=24(PSH|ACK), checksum=OK, len=441

### –û–∂–∏–¥–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã zapret-style:
- **Fake –ø–∞–∫–µ—Ç:** TTL=1, flags=24(PSH|ACK), checksum=BAD, len=~500
- **Real –ø–∞–∫–µ—Ç:** TTL=3, flags=24(PSH|ACK), checksum=OK, len=~517

## üîß –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–ò–ú–ï–ù–ï–ù–û

### ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è
```python
# –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–ê–Ø –ê–ö–¢–ò–í–ê–¶–ò–Ø –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
force_zapret = True  # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º zapret-style

if zapret_compatible or force_zapret:
```

### ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ø—Ä–∏–Ω—Ç—ã
```python
# –û–¢–õ–ê–î–ö–ê: –í—ã–≤–æ–¥–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
self.logger.info(f"üîç DEBUG: split_pos={split_pos}, fooling_list={fooling_list}")
self.logger.info(f"üîç DEBUG: zapret_compatible={zapret_compatible}")

if force_zapret:
    self.logger.info("üö® FORCE ZAPRET-STYLE ACTIVATED FOR DEBUG!")
```

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ü–æ—Å–ª–µ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:
1. **Zapret-style –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –í–°–ï–ì–î–ê** (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)
2. **–í—ã–≤–æ–¥—è—Ç—Å—è –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
3. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–∫–µ—Ç–æ–≤:**
   - Fake: TTL=1, PSH|ACK, badsum, ~500 –±–∞–π—Ç
   - Real: TTL=3, PSH|ACK, good checksum

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞–∫–µ—Ç–æ–≤:
```
1. fake ClientHello (TTL=1, badsum, ~500 –±–∞–π—Ç)
2. [–∑–∞–¥–µ—Ä–∂–∫–∞ 1ms]
3. real segment 1 (TTL=3, good checksum, 3 –±–∞–π—Ç–∞)
4. real segment 2 (TTL=3, good checksum, ~514 –±–∞–π—Ç)
```

## üìÅ –ò–ó–ú–ï–ù–ï–ù–ù–´–ï –§–ê–ô–õ–´

### `recon/core/bypass/engine/windows_engine.py`
- **–°—Ç—Ä–æ–∫–∞ 1117:** –î–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ø—Ä–∏–Ω—Ç—ã
- **–°—Ç—Ä–æ–∫–∞ 1121:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è
- **–°—Ç—Ä–æ–∫–∞ 1123:** –î–æ–±–∞–≤–ª–µ–Ω–æ —É—Å–ª–æ–≤–∏–µ `or force_zapret`

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –¢–µ—Å—Ç: `recon/test_force_zapret.py`
```bash
python test_force_zapret.py
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–ê–Ø –ê–ö–¢–ò–í–ê–¶–ò–Ø –ù–ê–°–¢–†–û–ï–ù–ê!

## üéØ –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ü–†–ò–ß–ò–ù –ù–ï–ê–ö–¢–ò–í–ê–¶–ò–ò

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø–æ—á–µ–º—É zapret-style –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª—Å—è:
1. **split_pos != 3** –≤ —Ç–µ—Å—Ç–∏—Ä—É–µ–º—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ö
2. **"badsum" –Ω–µ –≤ fooling** –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö
3. **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–∞—è –≤–µ—Ç–∫–∞ –∫–æ–¥–∞** (–∫–∞–ª–∏–±—Ä–∞—Ç–æ—Ä)
4. **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**

### –†–µ—à–µ–Ω–∏–µ:
- **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è** –æ–±—Ö–æ–¥–∏—Ç –≤—Å–µ —É—Å–ª–æ–≤–∏—è
- **–û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ø—Ä–∏–Ω—Ç—ã** –ø–æ–∫–∞–∂—É—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- **Zapret-style –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ–≥–¥–∞**

## ‚úÖ –°–¢–ê–¢–£–°: –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–ê–Ø –ê–ö–¢–ò–í–ê–¶–ò–Ø –í–ö–õ–Æ–ß–ï–ù–ê

**üö® –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï:**
- Zapret-style —Ç–µ–ø–µ—Ä—å –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–û
- –î–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–∫–µ—Ç–æ–≤ –±—É–¥—É—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏

**üöÄ –ì–û–¢–û–í–û –ö –ü–û–í–¢–û–†–ù–û–ú–£ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ**

---

*–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É zapret-style –ª–æ–≥–∏–∫–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π.*