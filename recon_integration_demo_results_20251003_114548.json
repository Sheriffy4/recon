{
  "demo_metadata": {
    "timestamp": "2025-10-03T11:45:48.220603",
    "demo_type": "recon_integration_comprehensive",
    "components_tested": [
      "ReconIntegrationManager",
      "EnhancedRSTCompatibilityLayer",
      "StrategyManagementIntegration",
      "HistoricalDataIntegration"
    ]
  },
  "demo_results": {
    "integration_status": {
      "integration_manager": {
        "available_components": [
          "pcap_analysis",
          "find_rst_triggers",
          "enhanced_find_rst_triggers",
          "strategy_rule_engine",
          "intelligent_strategy_generator",
          "enhanced_rst_analyzer"
        ],
        "integration_capabilities": {
          "find_rst_triggers": true,
          "enhanced_find_rst_triggers": true,
          "strategy_rule_engine": true,
          "intelligent_strategy_generator": true,
          "enhanced_rst_analyzer": true
        },
        "historical_data_status": {
          "recon_summary_available": true,
          "strategies_in_history": 3,
          "effectiveness_data_available": true
        },
        "pcap_analysis_capabilities": [
          "packet_sequence_comparison",
          "strategy_parameter_analysis",
          "timing_pattern_analysis",
          "fake_packet_detection",
          "split_position_analysis"
        ]
      },
      "rst_compatibility": {
        "enhanced_rst_finder_available": true,
        "enhanced_rst_analyzer_available": true,
        "integration_manager_status": {
          "available_components": [
            "pcap_analysis",
            "find_rst_triggers",
            "enhanced_find_rst_triggers",
            "strategy_rule_engine",
            "intelligent_strategy_generator",
            "enhanced_rst_analyzer"
          ],
          "integration_capabilities": {
            "find_rst_triggers": true,
            "enhanced_find_rst_triggers": true,
            "strategy_rule_engine": true,
            "intelligent_strategy_generator": true,
            "enhanced_rst_analyzer": true
          },
          "historical_data_status": {
            "recon_summary_available": true,
            "strategies_in_history": 3,
            "effectiveness_data_available": true
          },
          "pcap_analysis_capabilities": [
            "packet_sequence_comparison",
            "strategy_parameter_analysis",
            "timing_pattern_analysis",
            "fake_packet_detection",
            "split_position_analysis"
          ]
        },
        "compatibility_level": "FULL"
      },
      "strategy_integration": {
        "available_components": [
          "pcap_analysis",
          "strategy_combinator",
          "strategy_selector",
          "strategy_config_manager",
          "intelligent_strategy_generator"
        ],
        "component_status": {
          "strategy_combinator": true,
          "strategy_selector": true,
          "strategy_config_manager": true,
          "intelligent_generator": true
        },
        "configuration_status": {
          "strategy_config_exists": true,
          "recon_summary_exists": true,
          "active_strategies_count": 0
        },
        "integration_capabilities": [
          "strategy_unification",
          "effectiveness_tracking",
          "configuration_updates",
          "cross_validation"
        ]
      },
      "historical_integration": {
        "data_statistics": {
          "total_historical_records": 3,
          "successful_strategies": 0,
          "unique_strategies": 3,
          "data_file_exists": true
        },
        "analysis_capabilities": {
          "effectiveness_trends": true,
          "failure_patterns": true,
          "success_patterns": true,
          "parameter_analysis": true
        },
        "insights_available": {
          "success_factors": 0,
          "failure_warnings": 3,
          "parameter_recommendations": 4
        }
      }
    },
    "historical_integration": {
      "relevant_historical_strategies": [
        {
          "strategy": "fakeddisorder(fooling=['badsum'], overlap_size=336, split_pos=76, ttl=3)",
          "success_rate": 0.0,
          "relevance_score": 1.0,
          "addresses_issues": {
            "ttl_issues": true,
            "split_issues": true,
            "fake_issues": true
          }
        },
        {
          "strategy": "--dpi-desync=fake,disorder --dpi-desync-fooling=badsum --dpi-desync-split-pos=76 --dpi-desync-ttl=3",
          "success_rate": 0.0,
          "relevance_score": 1.0,
          "addresses_issues": {
            "ttl_issues": true,
            "split_issues": true,
            "fake_issues": true
          }
        },
        {
          "strategy": "fakeddisorder(fooling=['badsum', 'badseq'], overlap_size=0, split_pos=3, ttl=3)",
          "success_rate": 0.0,
          "relevance_score": 1.0,
          "addresses_issues": {
            "ttl_issues": true,
            "split_issues": true,
            "fake_issues": true
          }
        }
      ],
      "parameter_recommendations": {
        "ttl_recommendation": {},
        "split_pos_recommendation": {},
        "fooling_recommendation": {},
        "strategy_type_recommendation": {}
      },
      "failure_warnings": [
        "Warning: TTL=3 has failed 3 times historically",
        "Warning: fooling=badsum has failed 3 times historically"
      ],
      "success_predictions": {
        "overall_success_probability": 0.0,
        "parameter_success_probabilities": {},
        "strategy_success_probabilities": {},
        "confidence_level": "LOW"
      },
      "historical_insights": [
        "Best Historical Strategy: fakeddisorder(fooling=['badsum'], overlap_size=336, split_pos=76, ttl=3) (avg success: 0.0%)",
        "Most Failed Strategy: fakeddisorder(fooling=['badsum'], overlap_size=336, split_pos=76, ttl=3) (1 failures)",
        "Historical Data: 3 total attempts, 0.0% overall success rate"
      ]
    },
    "pcap_with_history": {
      "analysis_metadata": {
        "start_time": "2025-10-03T11:45:48.198540",
        "recon_pcap": "recon_x.pcap",
        "zapret_pcap": "zapret_x.pcap",
        "target_domain": "x.com",
        "integration_components": [
          "pcap_analysis",
          "find_rst_triggers",
          "enhanced_find_rst_triggers",
          "strategy_rule_engine",
          "intelligent_strategy_generator",
          "enhanced_rst_analyzer"
        ],
        "end_time": "2025-10-03T11:45:48.201891",
        "duration_seconds": 0.003351
      },
      "pcap_comparison": {
        "summary": {
          "files_compared": {
            "recon": "recon_x.pcap",
            "zapret": "zapret_x.pcap"
          },
          "packet_counts": {
            "recon": 6,
            "zapret": 6,
            "difference": 0
          },
          "similarity_score": 1.0,
          "differences_found": {
            "sequence": 0,
            "timing": 0,
            "parameters": 0
          },
          "critical_issues": 0,
          "recommendations": 0,
          "connections": {
            "recon": 6,
            "zapret": 6
          }
        },
        "similarity_score": 1.0,
        "sequence_differences": [],
        "timing_differences": [],
        "parameter_differences": [],
        "critical_issues": [],
        "recommendations": [],
        "detected_strategies": {},
        "strategy_effectiveness": {},
        "analysis_metadata": {
          "timestamp": 1759481148.19854,
          "recon_file": "recon_x.pcap",
          "zapret_file": "zapret_x.pcap"
        }
      },
      "historical_context": {
        "relevant_strategies": [
          {
            "strategy": "fakeddisorder(fooling=['badsum'], overlap_size=336, split_pos=76, ttl=3)",
            "success_rate": 0.0,
            "result_status": "NO_SITES_WORKING",
            "engine_telemetry": {
              "segments_sent": 0,
              "fake_packets_sent": 0,
              "CH": 1,
              "SH": 0,
              "RST": 0
            }
          },
          {
            "strategy": "--dpi-desync=fake,disorder --dpi-desync-fooling=badsum --dpi-desync-split-pos=76 --dpi-desync-ttl=3",
            "success_rate": 0.0,
            "result_status": "NO_SITES_WORKING",
            "engine_telemetry": {
              "segments_sent": 0,
              "fake_packets_sent": 0,
              "CH": 1,
              "SH": 0,
              "RST": 0
            }
          },
          {
            "strategy": "fakeddisorder(fooling=['badsum', 'badseq'], overlap_size=0, split_pos=3, ttl=3)",
            "success_rate": 0.0,
            "result_status": "NO_SITES_WORKING",
            "engine_telemetry": {
              "segments_sent": 0,
              "fake_packets_sent": 0,
              "CH": 1,
              "SH": 1,
              "RST": 0
            }
          }
        ],
        "domain_specific_data": {
          "strategies_tested": 0,
          "successful_strategies": [],
          "failed_strategies": [],
          "domain_specific_patterns": []
        },
        "effectiveness_patterns": {
          "successful_strategies_count": 0,
          "failed_strategies_count": 3,
          "common_success_factors": [],
          "common_failure_factors": [
            "Failed strategies average 1.0 ClientHello packets",
            "Most failures are complete (NO_SITES_WORKING)"
          ]
        },
        "failure_patterns": {},
        "recommendations_from_history": [
          "Avoid failure pattern: Failed strategies average 1.0 ClientHello packets",
          "Avoid failure pattern: Most failures are complete (NO_SITES_WORKING)"
        ]
      },
      "rst_analysis": {
        "original_rst_analysis": {
          "method": "original_find_rst_triggers",
          "status": "simulated",
          "note": "Integration with find_rst_triggers.py"
        },
        "enhanced_rst_analysis": {
          "method": "enhanced_find_rst_triggers",
          "status": "simulated",
          "note": "Integration with enhanced_find_rst_triggers.py"
        },
        "integration_benefits": [
          "Combined PCAP analysis with RST trigger detection",
          "Historical context from recon_summary.json",
          "Enhanced strategy recommendations"
        ]
      },
      "strategy_recommendations": {
        "pcap_based_strategies": [
          {
            "strategy": "--dpi-desync=fake,fakeddisorder --dpi-desync-ttl=3 --dpi-desync-split-pos=3 --dpi-desync-fooling=badsum,badseq",
            "confidence": 0.8,
            "source": "pcap_pattern_analysis",
            "reasoning": "Detected fake packets with low TTL and disorder patterns"
          }
        ],
        "history_based_strategies": [],
        "combined_strategies": [
          {
            "strategy": "--dpi-desync=fake,fakeddisorder --dpi-desync-ttl=3 --dpi-desync-split-pos=3 --dpi-desync-fooling=badsum",
            "confidence": 0.9,
            "source": "intelligent_generation",
            "reasoning": "Combined PCAP analysis with historical effectiveness data"
          }
        ],
        "confidence_scores": {}
      },
      "integration_insights": {
        "data_sources_used": [
          "PCAP packet analysis",
          "Historical effectiveness data",
          "RST trigger analysis"
        ],
        "integration_advantages": [
          "Combined packet-level analysis with historical context",
          "Enhanced strategy recommendations using multiple data sources",
          "Improved confidence scoring through cross-validation",
          "Seamless workflow integration with existing tools"
        ],
        "limitations_addressed": [
          "PCAP-only analysis lacks historical context",
          "Historical data alone misses current packet patterns",
          "Isolated tools provide incomplete picture",
          "Manual correlation between different analysis results"
        ],
        "confidence_improvements": [
          "Enhanced confidence through intelligent strategy combination"
        ]
      },
      "actionable_fixes": [
        {
          "priority": "MEDIUM",
          "type": "strategy_implementation",
          "title": "Implement High-Confidence Strategy",
          "description": "Apply strategy: --dpi-desync=fake,fakeddisorder --dpi-desync-ttl=3 --dpi-desync-split-pos=3 --dpi-desync-fooling=badsum",
          "action": "Implement and test recommended strategy",
          "confidence": "HIGH",
          "source": "integrated_analysis"
        }
      ]
    },
    "strategy_integration": {
      "pcap_strategies": [
        {
          "strategy_command": "--dpi-desync=fake,fakeddisorder --dpi-desync-ttl=3 --dpi-desync-split-pos=3",
          "confidence": 0.8,
          "source": "pcap_analysis_pcap_based_strategies",
          "reasoning": "Detected fake disorder pattern in PCAP",
          "pcap_evidence": {
            "packet_patterns": [],
            "timing_analysis": {},
            "parameter_differences": [],
            "critical_issues": []
          }
        },
        {
          "strategy_command": "--dpi-desync=fake,fakeddisorder --dpi-desync-ttl=3 --dpi-desync-fooling=badsum",
          "confidence": 0.9,
          "source": "pcap_analysis_combined_strategies",
          "reasoning": "Combined PCAP and historical analysis",
          "pcap_evidence": {
            "packet_patterns": [],
            "timing_analysis": {},
            "parameter_differences": [],
            "critical_issues": []
          }
        },
        {
          "strategy_command": "--dpi-desync=fake --dpi-desync-ttl=1",
          "confidence": 0.8,
          "source": "pcap_analysis_fixes",
          "reasoning": "Apply strategy: --dpi-desync=fake --dpi-desync-ttl=1",
          "fix_priority": "MEDIUM"
        }
      ],
      "management_strategies": [
        {
          "strategy_command": "--dpi-desync=fake,fakeddisorder --dpi-desync-ttl=3 --dpi-desync-split-pos=3",
          "confidence": 0.7,
          "source": "strategy_combinator",
          "reasoning": "Generated by strategy combination logic",
          "combination_factors": [
            "fake",
            "fakeddisorder",
            "low_ttl"
          ]
        },
        {
          "strategy_command": "--dpi-desync=fake --dpi-desync-ttl=1 --dpi-desync-fooling=badsum",
          "confidence": 0.6,
          "source": "strategy_selector",
          "reasoning": "Selected based on domain characteristics",
          "selection_criteria": [
            "domain_type",
            "historical_effectiveness"
          ]
        },
        {
          "strategy_command": "--dpi-desync=fake,fakeddisorder --dpi-desync-split-pos=3 --dpi-desync-fooling=badsum,badseq --dpi-desync-ttl=3",
          "confidence": 0.9,
          "source": "intelligent_generator",
          "reasoning": "Generated using ML-enhanced analysis",
          "intelligence_factors": [
            "historical_data",
            "pattern_recognition",
            "effectiveness_prediction"
          ]
        }
      ],
      "unified_strategies": [
        {
          "strategy_command": "--dpi-desync=fake,fakeddisorder --dpi-desync-ttl=3 --dpi-desync-fooling=badsum",
          "confidence": 0.9,
          "source": "unified_integration",
          "reasoning": "Combined PCAP and historical analysis",
          "source_strategies": 1,
          "contributing_sources": [
            "pcap_analysis_combined_strategies"
          ],
          "target_domain": "x.com",
          "integration_metadata": {
            "created_at": "2025-10-03T11:45:48.202904",
            "unification_method": "weighted_confidence",
            "source_count": 1
          }
        },
        {
          "strategy_command": "--dpi-desync=fake,fakeddisorder --dpi-desync-split-pos=3 --dpi-desync-fooling=badsum,badseq --dpi-desync-ttl=3",
          "confidence": 0.9,
          "source": "unified_integration",
          "reasoning": "Generated using ML-enhanced analysis",
          "source_strategies": 1,
          "contributing_sources": [
            "intelligent_generator"
          ],
          "target_domain": "x.com",
          "integration_metadata": {
            "created_at": "2025-10-03T11:45:48.202904",
            "unification_method": "weighted_confidence",
            "source_count": 1
          }
        },
        {
          "strategy_command": "--dpi-desync=fake --dpi-desync-ttl=1",
          "confidence": 0.8000000000000002,
          "source": "unified_integration",
          "reasoning": "Apply strategy: --dpi-desync=fake --dpi-desync-ttl=1",
          "source_strategies": 1,
          "contributing_sources": [
            "pcap_analysis_fixes"
          ],
          "target_domain": "x.com",
          "integration_metadata": {
            "created_at": "2025-10-03T11:45:48.202904",
            "unification_method": "weighted_confidence",
            "source_count": 1
          }
        },
        {
          "strategy_command": "--dpi-desync=fake,fakeddisorder --dpi-desync-ttl=3 --dpi-desync-split-pos=3",
          "confidence": 0.7500000000000001,
          "source": "unified_integration",
          "reasoning": "Detected fake disorder pattern in PCAP; Generated by strategy combination logic",
          "source_strategies": 2,
          "contributing_sources": [
            "pcap_analysis_pcap_based_strategies",
            "strategy_combinator"
          ],
          "target_domain": "x.com",
          "integration_metadata": {
            "created_at": "2025-10-03T11:45:48.202904",
            "unification_method": "weighted_confidence",
            "source_count": 2
          }
        },
        {
          "strategy_command": "--dpi-desync=fake --dpi-desync-ttl=1 --dpi-desync-fooling=badsum",
          "confidence": 0.6,
          "source": "unified_integration",
          "reasoning": "Selected based on domain characteristics",
          "source_strategies": 1,
          "contributing_sources": [
            "strategy_selector"
          ],
          "target_domain": "x.com",
          "integration_metadata": {
            "created_at": "2025-10-03T11:45:48.202904",
            "unification_method": "weighted_confidence",
            "source_count": 1
          }
        }
      ],
      "integration_metadata": {
        "timestamp": "2025-10-03T11:45:48.202904",
        "target_domain": "x.com",
        "components_used": [
          "pcap_analysis",
          "strategy_combinator",
          "strategy_selector",
          "strategy_config_manager",
          "intelligent_strategy_generator"
        ]
      }
    },
    "rst_compatibility": {
      "analysis_metadata": {
        "start_time": "2025-10-03T11:45:48.212402",
        "primary_pcap": "test.pcap",
        "compatibility_layer": "enhanced_rst"
      },
      "enhanced_rst_analysis": {
        "strategies_generated": 12,
        "success_rate": 0.75
      },
      "integrated_results": {
        "strategy_recommendations": [
          {
            "strategy": "--dpi-desync=fake,fakeddisorder --dpi-desync-ttl=3",
            "confidence": 0.85,
            "validation_strength": "HIGH"
          }
        ],
        "confidence_scores": {
          "overall_confidence": 0.8,
          "cross_validation_confidence": 0.9
        }
      },
      "compatibility_report": {
        "compatibility_status": "FULL",
        "data_flow_validation": {
          "bidirectional_integration": true
        }
      }
    },
    "end_to_end_workflow": {
      "steps_completed": 5,
      "historical_records_used": 3,
      "pcap_similarity": 0.72,
      "strategies_generated": 3,
      "final_recommendations": 4,
      "integration_success": true
    }
  },
  "integration_summary": {
    "total_components": 4,
    "successful_demos": 6,
    "integration_level": "COMPREHENSIVE"
  }
}