# üîß –≠–¢–ê–ü 1: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï BADSUM –î–õ–Ø FAKE –ü–ê–ö–ï–¢–û–í

## üìä –ü–†–û–ë–õ–ï–ú–ê –ù–ê–ô–î–ï–ù–ê
–ê–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ PCAP –ø–æ–∫–∞–∑–∞–ª:
```json
"csum_fake_bad": false  // ‚ùå –î–æ–ª–∂–Ω–æ –±—ã—Ç—å true!
```

Fake –ø–∞–∫–µ—Ç—ã –∏–º–µ–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é checksum –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ—Ä—á–µ–Ω–Ω–æ–π.

## üîç –ö–û–†–ï–ù–¨ –ü–†–û–ë–õ–ï–ú–´
–í —Ñ—É–Ω–∫—Ü–∏–∏ `_send_attack_segments()` checksum –ø–æ—Ä—Ç–∏–ª–∞—Å—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –æ–ø—Ü–∏–π:
- `corrupt_tcp_checksum`
- `add_md5sig_option`

–ù–æ `BypassTechniques.apply_fakeddisorder()` –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —ç—Ç–∏ –æ–ø—Ü–∏–∏ –¥–ª—è fake –ø–∞–∫–µ—Ç–æ–≤.

## üîß –ú–ò–ù–ò–ú–ê–õ–¨–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï
–î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ—Ä—á–∞ checksum –¥–ª—è fake –ø–∞–∫–µ—Ç–æ–≤:

```python
# –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Ä—Ç–∏–º checksum –¥–ª—è fake –ø–∞–∫–µ—Ç–æ–≤
should_corrupt_checksum = (
    opts.get("corrupt_tcp_checksum") or 
    opts.get("add_md5sig_option") or
    opts.get("is_fake")  # –î–æ–±–∞–≤–ª—è–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø–æ—Ä—á—É –¥–ª—è fake –ø–∞–∫–µ—Ç–æ–≤
)

if should_corrupt_checksum:
    bad_csum = good_csum ^ 0xFFFF
    seg_raw[tcp_start+16:tcp_start+18] = struct.pack("!H", bad_csum)
    self.logger.debug(f"üîß Corrupted checksum for fake packet: {good_csum:04x} -> {bad_csum:04x}")
```

## üìà –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- `"csum_fake_bad": false` ‚ùå
- Fake –ø–∞–∫–µ—Ç—ã –∏–º–µ–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é checksum
- DPI –º–æ–≥ –∏—Ö –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- `"csum_fake_bad": true` ‚úÖ
- Fake –ø–∞–∫–µ—Ç—ã –∏–º–µ—é—Ç –∏—Å–ø–æ—Ä—á–µ–Ω–Ω—É—é checksum
- DPI –¥–æ–ª–∂–µ–Ω –∏—Ö –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –¢–µ—Å—Ç: `test_badsum_fix.py`
```bash
python test_badsum_fix.py
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù!

## üìÅ –ò–ó–ú–ï–ù–ï–ù–ù–´–ï –§–ê–ô–õ–´
- `recon/core/bypass/engine/windows_engine.py` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ—Ä—á–∞ checksum

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –≠–¢–ê–ü–´
1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç
2. **–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É–ª—É—á—à–∏—Ç—Å—è** - –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –¥—Ä—É–≥–∏–º–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏
3. **–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É—Ö—É–¥—à–∏—Ç—Å—è** - –æ—Ç–∫–∞—Ç–∏—Ç—å –∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥

## ‚úÖ –°–¢–ê–¢–£–°: –≠–¢–ê–ü 1 –ó–ê–í–ï–†–®–ï–ù
**–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ badsum –ø—Ä–∏–º–µ–Ω–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é.**