{
  "patterns": [
    {
      "id": "sni_block_rst_fast",
      "description": "SNI блокировка с быстрым RST",
      "conditions": {
        "root_cause": "DPI_SNI_FILTERING",
        "indicators.any": [
          "rst_after_client_hello",
          "no_server_hello_after_sni"
        ],
        "rst_timing_ms.lt": 50
      },
      "recommend": [
        {
          "intent": "conceal_sni",
          "weight": 0.95
        },
        {
          "intent": "record_fragmentation",
          "weight": 0.85
        },
        {
          "intent": "fake_sni",
          "weight": 0.75
        }
      ],
      "tweaks": {
        "strategy_timeout_factor": 1.5,
        "ttl_adjustment": -2,
        "split_position_hint": "sni"
      },
      "metadata": {
        "success_count": 42,
        "failure_count": 3,
        "last_success": "2025-11-05T10:30:00Z",
        "confidence": 0.93,
        "domains_applied": [
          "youtube.com",
          "googlevideo.com",
          "ytimg.com"
        ],
        "created_at": "2025-11-01T00:00:00Z"
      }
    },
    {
      "id": "content_inspection_blackhole",
      "description": "Глубокая инспекция контента с черной дырой",
      "conditions": {
        "root_cause": "DPI_CONTENT_INSPECTION",
        "tls_alerts.none": [],
        "connection_established": true,
        "server_hello.none": []
      },
      "recommend": [
        {
          "intent": "payload_obfuscation",
          "weight": 0.9
        },
        {
          "intent": "sequence_overlap",
          "weight": 0.8
        },
        {
          "intent": "tls_extension_manipulation",
          "weight": 0.7
        }
      ],
      "tweaks": {
        "strategy_timeout_factor": 2.0,
        "enable_ipv6_fallback": true
      },
      "metadata": {
        "success_count": 28,
        "failure_count": 7,
        "last_success": "2025-11-04T15:20:00Z",
        "confidence": 0.8,
        "created_at": "2025-11-01T00:00:00Z"
      }
    },
    {
      "id": "stateless_dpi_fragment_bypass",
      "description": "Stateless DPI обходится фрагментацией",
      "conditions": {
        "root_cause": "DPI_REASSEMBLES_FRAGMENTS",
        "dpi_type": "STATELESS",
        "fragments_detected": true
      },
      "recommend": [
        {
          "intent": "packet_reordering",
          "weight": 0.9
        },
        {
          "intent": "out_of_order_decoy",
          "weight": 0.85
        }
      ],
      "tweaks": {
        "split_count_multiplier": 2,
        "disorder_enabled": true
      },
      "metadata": {
        "success_count": 15,
        "failure_count": 2,
        "confidence": 0.88,
        "created_at": "2025-11-01T00:00:00Z"
      }
    },
    {
      "id": "rst_injection_multiple_sources",
      "description": "RST инъекция с множественных источников",
      "conditions": {
        "root_cause": "DPI_ACTIVE_RST_INJECTION",
        "indicators.any": [
          "multiple_rst_sources",
          "suspicious_ttl"
        ],
        "rst_timing_ms.lt": 100
      },
      "recommend": [
        {
          "intent": "short_ttl_decoy",
          "weight": 0.95
        },
        {
          "intent": "timing_manipulation",
          "weight": 0.85
        },
        {
          "intent": "sequence_overlap",
          "weight": 0.75
        }
      ],
      "tweaks": {
        "ttl_adjustment": -3,
        "delay_ms": 50
      },
      "metadata": {
        "success_count": 35,
        "failure_count": 8,
        "confidence": 0.81,
        "created_at": "2025-11-01T00:00:00Z"
      }
    },
    {
      "id": "stateful_tracking_evasion",
      "description": "Stateful DPI отслеживание состояния",
      "conditions": {
        "root_cause": "DPI_STATEFUL_TRACKING",
        "indicators.any": [
          "stateful_evasion_failed"
        ]
      },
      "recommend": [
        {
          "intent": "sequence_overlap",
          "weight": 0.9
        },
        {
          "intent": "out_of_order_decoy",
          "weight": 0.85
        },
        {
          "intent": "timing_manipulation",
          "weight": 0.8
        }
      ],
      "tweaks": {
        "overlap_size": 4,
        "jitter_enabled": true
      },
      "metadata": {
        "success_count": 22,
        "failure_count": 5,
        "confidence": 0.81,
        "created_at": "2025-11-01T00:00:00Z"
      }
    },
    {
      "id": "google_services_pattern",
      "description": "Паттерн блокировки Google сервисов",
      "conditions": {
        "root_cause": "DPI_SNI_FILTERING",
        "indicators.any": [
          "rst_after_client_hello"
        ],
        "asn.any": [
          "AS15169"
        ]
      },
      "recommend": [
        {
          "intent": "conceal_sni",
          "weight": 0.95
        },
        {
          "intent": "fake_sni",
          "weight": 0.9
        },
        {
          "intent": "record_fragmentation",
          "weight": 0.8
        }
      ],
      "tweaks": {
        "strategy_timeout_factor": 1.8,
        "split_position_hint": "sni",
        "enable_ipv6_fallback": true
      },
      "metadata": {
        "success_count": 67,
        "failure_count": 12,
        "confidence": 0.85,
        "domains_applied": [
          "youtube.com",
          "googlevideo.com",
          "googleapis.com"
        ],
        "created_at": "2025-11-01T00:00:00Z"
      }
    },
    {
      "id": "auto_network_timeout_20251112_145230",
      "description": "Auto-generated from www.googlevideo.com",
      "conditions": {
        "root_cause": "network_timeout"
      },
      "recommend": [
        {
          "intent": "basic_fragmentation",
          "weight": 0.8
        },
        {
          "intent": "basic_sni_concealment",
          "weight": 0.8
        }
      ],
      "tweaks": {
        "ttl_adjustment": -63,
        "split_position_hint": 3
      },
      "metadata": {
        "success_count": 3,
        "failure_count": 63,
        "last_success": "2025-11-17T15:07:25.152993",
        "confidence": 0.045454545454545456,
        "domains_applied": [
          "www.googlevideo.com",
          "rr4---sn-4pvgq-n8v6.googlevideo.com",
          "i.ytimg.com"
        ],
        "auto_generated": true,
        "created_at": "2025-11-12T14:52:30.700233"
      }
    },
    {
      "id": "auto_dpi_content_inspection_20251120_152115",
      "description": "Auto-generated from www.googlevideo.com",
      "conditions": {
        "root_cause": "dpi_content_inspection",
        "asn.any": [
          15169
        ]
      },
      "recommend": [
        {
          "intent": "basic_fragmentation",
          "weight": 0.8
        },
        {
          "intent": "simple_reordering",
          "weight": 0.8
        },
        {
          "intent": "basic_sni_concealment",
          "weight": 0.8
        }
      ],
      "tweaks": {
        "ttl_adjustment": -63,
        "split_position_hint": 2
      },
      "metadata": {
        "success_count": 2,
        "failure_count": 181,
        "last_success": "2025-11-20T15:38:48.007798",
        "confidence": 0.01092896174863388,
        "domains_applied": [
          "www.googlevideo.com"
        ],
        "auto_generated": true,
        "created_at": "2025-11-20T15:21:15.880393"
      }
    },
    {
      "id": "auto_dpi_stateful_tracking_20251120_160032",
      "description": "Auto-generated from www.googlevideo.com",
      "conditions": {
        "root_cause": "dpi_stateful_tracking",
        "asn.any": [
          15169
        ]
      },
      "recommend": [
        {
          "intent": "out_of_order_decoy",
          "weight": 0.8
        },
        {
          "intent": "record_fragmentation",
          "weight": 0.8
        }
      ],
      "tweaks": {
        "ttl_adjustment": -63,
        "split_position_hint": 2
      },
      "metadata": {
        "success_count": 1,
        "failure_count": 66,
        "last_success": "2025-11-20T16:00:32.287447",
        "confidence": 0.014925373134328358,
        "domains_applied": [
          "www.googlevideo.com"
        ],
        "auto_generated": true,
        "created_at": "2025-11-20T16:00:32.287447"
      }
    },
    {
      "id": "auto_dpi_active_rst_injection_20251120_162547",
      "description": "Auto-generated from www.googlevideo.com",
      "conditions": {
        "root_cause": "dpi_active_rst_injection",
        "asn.any": [
          15169
        ]
      },
      "recommend": [
        {
          "intent": "conceal_sni",
          "weight": 0.8
        },
        {
          "intent": "record_fragmentation",
          "weight": 0.8
        },
        {
          "intent": "fake_sni",
          "weight": 0.8
        }
      ],
      "tweaks": {
        "ttl_adjustment": -63,
        "split_position_hint": 3
      },
      "metadata": {
        "success_count": 1,
        "failure_count": 223,
        "last_success": "2025-11-20T16:25:47.718810",
        "confidence": 0.004464285714285714,
        "domains_applied": [
          "www.googlevideo.com"
        ],
        "auto_generated": true,
        "created_at": "2025-11-20T16:25:47.718810"
      }
    },
    {
      "id": "auto_dpi_sni_filtering_20251121_105754",
      "description": "Auto-generated from www.googlevideo.com",
      "conditions": {
        "root_cause": "dpi_sni_filtering",
        "asn.any": [
          15169
        ]
      },
      "recommend": [
        {
          "intent": "basic_fragmentation",
          "weight": 0.8
        },
        {
          "intent": "simple_reordering",
          "weight": 0.8
        }
      ],
      "tweaks": {
        "split_position_hint": 3
      },
      "metadata": {
        "success_count": 1,
        "failure_count": 33,
        "last_success": "2025-11-21T10:57:54.336341",
        "confidence": 0.029411764705882353,
        "domains_applied": [
          "www.googlevideo.com"
        ],
        "auto_generated": true,
        "created_at": "2025-11-21T10:57:54.336341"
      }
    },
    {
      "id": "auto_unknown_20251121_120257",
      "description": "Auto-generated from www.googlevideo.com",
      "conditions": {
        "root_cause": "unknown",
        "asn.any": [
          15169
        ]
      },
      "recommend": [
        {
          "intent": "short_ttl_decoy",
          "weight": 0.8
        }
      ],
      "tweaks": {
        "ttl_adjustment": -61,
        "split_position_hint": "sni"
      },
      "metadata": {
        "success_count": 1,
        "failure_count": 85,
        "last_success": "2025-11-21T12:02:57.526873",
        "confidence": 0.011627906976744186,
        "domains_applied": [
          "www.googlevideo.com"
        ],
        "auto_generated": true,
        "created_at": "2025-11-21T12:02:57.526873"
      }
    },
    {
      "id": "auto_dpi_sni_filtering_20251121_122811",
      "description": "Auto-generated from www.youtube.com",
      "conditions": {
        "root_cause": "dpi_sni_filtering"
      },
      "recommend": [
        {
          "intent": "simple_reordering",
          "weight": 0.8
        },
        {
          "intent": "basic_sni_concealment",
          "weight": 0.8
        }
      ],
      "tweaks": {
        "ttl_adjustment": -63
      },
      "metadata": {
        "success_count": 1,
        "failure_count": 9,
        "last_success": "2025-11-21T12:28:11.969787",
        "confidence": 0.1,
        "domains_applied": [
          "www.youtube.com"
        ],
        "auto_generated": true,
        "created_at": "2025-11-21T12:28:11.969787"
      }
    }
  ],
  "global_settings": {
    "min_confidence_threshold": 0.7,
    "max_patterns_per_match": 3,
    "pattern_ttl_days": 30,
    "auto_prune_low_confidence": true,
    "version": "1.0",
    "last_updated": "2025-11-05T00:00:00Z"
  },
  "batch_info": {
    "last_save": "2025-12-01T14:53:28.606254",
    "pending_updates_processed": 2,
    "total_updates": 2
  }
}