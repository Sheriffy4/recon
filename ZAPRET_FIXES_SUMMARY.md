# –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º zapret —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

## üéØ –¶–µ–ª—å
–ò—Å–ø—Ä–∞–≤–∏—Ç—å 4 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å zapret —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å—é:
1. ‚ùå Checksum –Ω–µ –∏—Å–ø–æ—Ä—á–µ–Ω (`csum_fake_bad: false`)
2. ‚ùå –ù–µ—Ç PSH —Ñ–ª–∞–≥–∞ (`flags_real_psh: false`)
3. ‚ùå –ú–µ–¥–ª–µ–Ω–Ω—ã–π timing (1.9ms –≤–º–µ—Å—Ç–æ <0.1ms)
4. ‚ùå –ú–∞–ª–µ–Ω—å–∫–∏–π fake –ø–∞–∫–µ—Ç (74 –±–∞–π—Ç–∞ –≤–º–µ—Å—Ç–æ >500)

## üîß –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SNI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
**–§–∞–π–ª:** `recon/core/bypass/engine/windows_engine.py`
**–°—Ç—Ä–æ–∫–∏:** 405-409

```python
# –ë–´–õ–û:
random_part = ''.join(random.choices(string.ascii_lowercase, k=random.randint(10, 15)))
tld = random.choice(['edu', 'org', 'net', 'gov'])
fake_sni = f"{random_part}.{tld}"

# –°–¢–ê–õ–û:
random_part = ''.join(random.choices(string.ascii_lowercase + string.digits, k=12))
fake_sni = f"{random_part}.edu"  # –í—Å–µ–≥–¥–∞ .edu –∫–∞–∫ –≤ zapret
```

### 2. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è zapret-style –ø—É—Ç–∏
**–§–∞–π–ª:** `recon/core/bypass/engine/windows_engine.py`
**–°—Ç—Ä–æ–∫–∏:** 1064-1070

```python
# –ë–´–õ–û:
is_simple = forced_nofallback or bool(params.get("simple", False) or params.get("force_simple", False)) or zapret_compatible

# –°–¢–ê–õ–û:
is_simple = True  # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º zapret-style
if zapret_compatible:
    self.logger.info("üéØ ZAPRET-COMPATIBLE CONDITIONS DETECTED!")
```

### 3. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è zapret-style –≤–µ—Ç–∫–∏
**–§–∞–π–ª:** `recon/core/bypass/engine/windows_engine.py`
**–°—Ç—Ä–æ–∫–∏:** 1085-1087

```python
# –ë–´–õ–û:
if split_pos == 3 and "badsum" in fooling_list:

# –°–¢–ê–õ–û:
if True:  # –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º zapret-style –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
```

### 4. –£—Å–∏–ª–µ–Ω–∏–µ –æ—Ç–ª–∞–¥–∫–∏ checksum
**–§–∞–π–ª:** `recon/core/bypass/engine/windows_engine.py`
**–°—Ç—Ä–æ–∫–∏:** 1530-1532

```python
# –î–û–ë–ê–í–õ–ï–ù–û:
self.logger.info(f"üîß CHECKSUM DEBUG: good={good_csum:04x}, bad={bad_csum:04x}, len={len(fake_payload)}")
```

### 5. –£—Å–∏–ª–µ–Ω–∏–µ –æ—Ç–ª–∞–¥–∫–∏ PSH —Ñ–ª–∞–≥–æ–≤
**–§–∞–π–ª:** `recon/core/bypass/engine/windows_engine.py`
**–°—Ç—Ä–æ–∫–∏:** 1605-1607

```python
# –î–û–ë–ê–í–õ–ï–ù–û:
self.logger.info(f"üö© REAL segment {i+1}: flags=0x18 (PSH|ACK), len={len(data)}, ttl={ttl}")
```

### 6. –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏
**–§–∞–π–ª:** `recon/core/bypass/engine/windows_engine.py`
**–°—Ç—Ä–æ–∫–∏:** 1093

```python
# –ë–´–õ–û:
time.sleep(0.00005)  # 0.05ms –∫–∞–∫ –≤ zapret

# –°–¢–ê–õ–û:
pass  # –ù–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É fake –∏ real –∫–∞–∫ –≤ zapret
```

## üß™ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

### 1. –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç
**–§–∞–π–ª:** `recon/diagnose_zapret_issues.py`
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç PCAP –¥–∞–Ω–Ω—ã–µ
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 2. –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
**–§–∞–π–ª:** `recon/simple_zapret_test.py`
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –ø–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏—é fake SNI
- –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π

### 3. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ—Å—Ç –æ–±—Ö–æ–¥–∞
**–§–∞–π–ª:** `recon/force_bypass_test.py`
- –°–æ–∑–¥–∞–µ—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ–º–µ–Ω
- –ó–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –æ–±—Ö–æ–¥–∞
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤ –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è:
- `üéØ ZAPRET-COMPATIBLE CONDITIONS DETECTED!`
- `üéØ ZAPRET-STYLE ACTIVATED: split_pos=3 with fooling=['badsum', 'badseq']`
- `üé≠ Sending FULL fake with corrupted checksum and fake SNI...`
- `üîß CHECKSUM DEBUG: good=xxxx, bad=yyyy, len=zzz`
- `üö© REAL segment 1: flags=0x18 (PSH|ACK), len=xxx, ttl=3`

–í PCAP –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
- `csum_fake_bad: true` (–∏—Å–ø–æ—Ä—á–µ–Ω–Ω–∞—è checksum)
- `flags_real_psh: true` (PSH —Ñ–ª–∞–≥ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–∞–∫–µ—Ç–∞—Ö)
- `pair_dt_ms < 0.1` (–±—ã—Å—Ç—Ä—ã–π timing)
- `fake.len > 500` (–ø–æ–ª–Ω—ã–π ClientHello)

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –¥–æ–º–µ–Ω–æ–º:**
   ```bash
   python force_bypass_test.py
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π**

3. **–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π PCAP —Ñ–∞–π–ª:**
   ```bash
   python diagnose_zapret_issues.py
   ```

4. **–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Ç–∫–∞—Ç–∏—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
   - –£–±—Ä–∞—Ç—å `is_simple = True`
   - –í–µ—Ä–Ω—É—Ç—å —É—Å–ª–æ–≤–∏–µ `if split_pos == 3 and "badsum" in fooling_list:`

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–¥–µ–ª–∞–Ω—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ zapret-style –ø—É—Ç–∏
- –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω—É–∂–Ω–æ —É–±—Ä–∞—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- –ö–æ–¥ –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å zapret-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —É—Å–ª–æ–≤–∏—è
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ —Ç–æ—á–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è zapret

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

‚úÖ **–£—Å–ø–µ—Ö –¥–æ—Å—Ç–∏–≥–Ω—É—Ç, –µ—Å–ª–∏:**
- –í –ª–æ–≥–∞—Ö –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤—Å–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- PCAP –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- –û–±—Ö–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
- Timing < 0.1ms, fake –ø–∞–∫–µ—Ç > 500 –±–∞–π—Ç, checksum –∏—Å–ø–æ—Ä—á–µ–Ω, PSH —Ñ–ª–∞–≥–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç