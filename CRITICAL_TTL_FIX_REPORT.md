# üéØ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï TTL –î–õ–Ø FAKE –ü–ê–ö–ï–¢–û–í

## üìä –ü–†–û–ë–õ–ï–ú–ê –û–ë–ù–ê–†–£–ñ–ï–ù–ê
–ü–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ out2.pcap –≤—ã—è—Å–Ω–∏–ª–æ—Å—å, —á—Ç–æ zapret-style –ø–∞–∫–µ—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è, –Ω–æ –æ–±—Ö–æ–¥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (0% —É—Å–ø–µ—Ö–∞).

### –ê–Ω–∞–ª–∏–∑ PCAP –ø–æ–∫–∞–∑–∞–ª:
- ‚úÖ **TTL=3 –ø–∞–∫–µ—Ç–æ–≤: 1760** (fake –ø–∞–∫–µ—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è)
- ‚úÖ **–ü–∞–∫–µ—Ç–æ–≤ 400-600 –±–∞–π—Ç: 1728** (fake ClientHello –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è)
- ‚úÖ **–ü–∞–∫–µ—Ç–æ–≤ 3 –±–∞–π—Ç–∞: 137** (–ø–µ—Ä–≤—ã–µ real —Å–µ–≥–º–µ–Ω—Ç—ã)
- ‚úÖ **–ü–∞–∫–µ—Ç–æ–≤ 514 –±–∞–π—Ç: 137** (–≤—Ç–æ—Ä—ã–µ real —Å–µ–≥–º–µ–Ω—Ç—ã)
- ‚ùå **–í—Å–µ TLS –ø–∞–∫–µ—Ç—ã –∏–º–µ—é—Ç TTL=128** (–ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)

## üîß –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–ò–ú–ï–ù–ï–ù–´

### 1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω TTL –¥–ª—è fake –ø–∞–∫–µ—Ç–æ–≤
**–î–û:** Fake –ø–∞–∫–µ—Ç—ã –∏–º–µ–ª–∏ TTL=3 (–º–æ–≥–ª–∏ –¥–æ–π—Ç–∏ –¥–æ —Å–µ—Ä–≤–µ—Ä–∞)
**–ü–û–°–õ–ï:** Fake –ø–∞–∫–µ—Ç—ã –∏–º–µ—é—Ç TTL=1 (–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –Ω–µ –¥–æ–π–¥—É—Ç –¥–æ —Å–µ—Ä–≤–µ—Ä–∞)

### 2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ checksum –¥–ª—è real —Å–µ–≥–º–µ–Ω—Ç–æ–≤
**–î–û:** Real —Å–µ–≥–º–µ–Ω—Ç—ã –º–æ–≥–ª–∏ –∏–º–µ—Ç—å –∏—Å–ø–æ—Ä—á–µ–Ω–Ω—É—é checksum
**–ü–û–°–õ–ï:** –¢–æ–ª—å–∫–æ fake –ø–∞–∫–µ—Ç—ã –∏–º–µ—é—Ç badsum, real —Å–µ–≥–º–µ–Ω—Ç—ã –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é checksum

### 3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏
**–î–û:** –ü–∞–∫–µ—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏—Å—å –±–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏
**–ü–û–°–õ–ï:** 1ms –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É fake –∏ real –ø–∞–∫–µ—Ç–∞–º–∏ (–∫–∞–∫ –≤ zapret)

### 4. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã TTL –∑–Ω–∞—á–µ–Ω–∏—è
- **Fake –ø–∞–∫–µ—Ç—ã:** TTL=1 (–Ω–µ –¥–æ–π–¥—É—Ç –¥–æ —Å–µ—Ä–≤–µ—Ä–∞)
- **Real —Å–µ–≥–º–µ–Ω—Ç—ã:** TTL=3 (–¥–æ–π–¥—É—Ç –¥–æ —Å–µ—Ä–≤–µ—Ä–∞)

## üìà –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è zapret-style –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

1. **Fake ClientHello** (~500 –±–∞–π—Ç):
   ```
   - TTL: 1 (–ù–ï –¥–æ–π–¥–µ—Ç –¥–æ —Å–µ—Ä–≤–µ—Ä–∞)
   - Checksum: –∏—Å–ø–æ—Ä—á–µ–Ω–Ω–∞—è (badsum)
   - SNI: –ø–æ–¥–¥–µ–ª—å–Ω—ã–π
   - Flags: PSH|ACK
   ```

2. **[–ó–∞–¥–µ—Ä–∂–∫–∞ 1ms]**

3. **Real Segment 1** (3 –±–∞–π—Ç–∞):
   ```
   - TTL: 3 (–¥–æ–π–¥–µ—Ç –¥–æ —Å–µ—Ä–≤–µ—Ä–∞)
   - Checksum: –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
   - Payload: –ø–µ—Ä–≤—ã–µ 3 –±–∞–π—Ç–∞ ClientHello
   - Flags: PSH|ACK
   ```

4. **Real Segment 2** (~514 –±–∞–π—Ç):
   ```
   - TTL: 3 (–¥–æ–π–¥–µ—Ç –¥–æ —Å–µ—Ä–≤–µ—Ä–∞)
   - Checksum: –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
   - Payload: –æ—Å—Ç–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å ClientHello
   - Flags: PSH|ACK
   ```

## üéØ –õ–û–ì–ò–ö–ê –û–ë–•–û–î–ê

1. **DPI –≤–∏–¥–∏—Ç fake ClientHello** —Å –ø–æ–¥–¥–µ–ª—å–Ω—ã–º SNI –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç –µ–≥–æ
2. **Fake –ø–∞–∫–µ—Ç –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ —Å–µ—Ä–≤–µ—Ä–∞** (TTL=1)
3. **DPI –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç real —Å–µ–≥–º–µ–Ω—Ç—ã** (–¥—É–º–∞–µ—Ç, —á—Ç–æ —É–∂–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ)
4. **Real —Å–µ–≥–º–µ–Ω—Ç—ã —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ** –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π ClientHello
5. **–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ**

## üìÅ –ò–ó–ú–ï–ù–ï–ù–ù–´–ï –§–ê–ô–õ–´

### `recon/core/bypass/engine/windows_engine.py`
- **–°—Ç—Ä–æ–∫–∏ 1119-1127:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã TTL –∑–Ω–∞—á–µ–Ω–∏—è
- **–°—Ç—Ä–æ–∫–∞ 1125:** –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ 1ms
- **–°—Ç—Ä–æ–∫–∞ 2370:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ checksum –¥–ª—è real —Å–µ–≥–º–µ–Ω—Ç–æ–≤

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –¢–µ—Å—Ç: `recon/test_ttl_fix.py`
```bash
python test_ttl_fix.py
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù!

## üìä –°–†–ê–í–ù–ï–ù–ò–ï –î–û –ò –ü–û–°–õ–ï

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
|----------|----------------|-------------------|
| **Fake TTL** | 3 | 1 |
| **Real TTL** | 3 | 3 |
| **Fake checksum** | –ò—Å–ø–æ—Ä—á–µ–Ω–Ω–∞—è | –ò—Å–ø–æ—Ä—á–µ–Ω–Ω–∞—è |
| **Real checksum** | –ò—Å–ø–æ—Ä—á–µ–Ω–Ω–∞—è | –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è |
| **–ó–∞–¥–µ—Ä–∂–∫–∞** | –ù–µ—Ç | 1ms |
| **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å** | 0% | –û–∂–∏–¥–∞–µ—Ç—Å—è 15%+ |

## ‚úÖ –°–¢–ê–¢–£–°: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–ò–ú–ï–ù–ï–ù–´

**üéØ –û–°–ù–û–í–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –†–ï–®–ï–ù–´:**
- TTL fake –ø–∞–∫–µ—Ç–æ–≤ —É–º–µ–Ω—å—à–µ–Ω –¥–æ 1
- Real —Å–µ–≥–º–µ–Ω—Ç—ã –∏–º–µ—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é checksum
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–∞–∫–µ—Ç–∞–º–∏
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ö–æ–¥–∞

**üöÄ –ì–û–¢–û–í–û –ö –ü–û–í–¢–û–†–ù–û–ú–£ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ**

---

*–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –∞–Ω–∞–ª–∏–∑–µ PCAP —Ñ–∞–π–ª–æ–≤ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å —Ä–∞–±–æ—Ç–∞—é—â–∏–º zapret.*