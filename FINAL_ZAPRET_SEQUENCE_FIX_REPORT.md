# üéØ –§–ò–ù–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï ZAPRET-STYLE –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–ò –ü–ê–ö–ï–¢–û–í

## üìä –†–ï–ó–Æ–ú–ï –ü–†–û–ë–õ–ï–ú–´
**–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê –ù–ê–ô–î–ï–ù–ê –ò –ò–°–ü–†–ê–í–õ–ï–ù–ê:**
- Recon –æ—Ç–ø—Ä–∞–≤–ª—è–ª **5 –ø–∞–∫–µ—Ç–æ–≤** –≤–º–µ—Å—Ç–æ **3** –∫–∞–∫ zapret
- –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ **0% —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏** –æ–±—Ö–æ–¥–∞ DPI
- –ê–Ω–∞–ª–∏–∑ PCAP —Ñ–∞–π–ª–æ–≤ –≤—ã—è–≤–∏–ª –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞–∫–µ—Ç–æ–≤

## üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–ò–ú–ï–ù–ï–ù–û

### ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ zapret-—Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è –ª–æ–≥–∏–∫–∞:
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ zapret-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏:** `split_pos == 3 and "badsum" in fooling_list`
2. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** fake ClientHello ‚Üí real segment 1 ‚Üí real segment 2
3. **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –ø–∞–∫–µ—Ç–æ–≤:** –£–±—Ä–∞–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ fake —Å–µ–≥–º–µ–Ω—Ç—ã

### ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã zapret-style —Ñ—É–Ω–∫—Ü–∏–∏:
- `_send_full_fake_zapret_style()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ fake ClientHello —Å –ø–æ–¥–¥–µ–ª—å–Ω—ã–º SNI
- `_send_real_segments_zapret_style()` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–æ–ª—å–∫–æ 2 —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤
- `_generate_fake_sni()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–¥–¥–µ–ª—å–Ω—ã—Ö SNI –≤ —Ñ–æ—Ä–º–∞—Ç–µ zapret

## üìà –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
|----------|----------------|-------------------|
| **–£—Å–ø–µ—à–Ω–æ—Å—Ç—å** | 0% | 15%+ (–∫–∞–∫ zapret) |
| **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–∫–µ—Ç–æ–≤** | 5 | 3 |
| **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è | Zapret-—Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è |
| **Fake ClientHello** | 77 –±–∞–π—Ç | ~500 –±–∞–π—Ç |
| **Checksum** | –í–∞–ª–∏–¥–Ω–∞—è | –ò—Å–ø–æ—Ä—á–µ–Ω–Ω–∞—è (badsum) |
| **SNI** | –†–µ–∞–ª—å–Ω—ã–π | –ü–æ–¥–¥–µ–ª—å–Ω—ã–π |

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π
```bash
python test_zapret_fix.py
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´!

### –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```bash
python test_zapret_sequence.py
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù!

## üéØ –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –î–ï–¢–ê–õ–ò–ó–ê–¶–ò–Ø

### –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è zapret-style –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

1. **Fake ClientHello** (~500 –±–∞–π—Ç):
   ```
   - TTL: fake_ttl (1-3)
   - Flags: PSH|ACK (0x18)
   - Checksum: –∏—Å–ø–æ—Ä—á–µ–Ω–Ω–∞—è (badsum)
   - SNI: –ø–æ–¥–¥–µ–ª—å–Ω—ã–π (—Ñ–æ—Ä–º–∞—Ç: 12—Å–∏–º–≤–æ–ª–æ–≤.edu)
   ```

2. **Real Segment 1** (3 –±–∞–π—Ç–∞):
   ```
   - TTL: 3
   - Flags: PSH|ACK (0x18)
   - Payload: –ø–µ—Ä–≤—ã–µ 3 –±–∞–π—Ç–∞ ClientHello
   ```

3. **Real Segment 2** (~514 –±–∞–π—Ç):
   ```
   - TTL: 3
   - Flags: PSH|ACK (0x18)
   - Payload: –æ—Å—Ç–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å ClientHello
   ```

## üöÄ –ê–ö–¢–ò–í–ê–¶–ò–Ø

Zapret-style –ª–æ–≥–∏–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏:
- `split_pos = 3`
- `fooling = ["badsum"]`

–ü—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã zapret:
```bash
--dpi-desync=fake,disorder --dpi-desync-split-pos=3 --dpi-desync-fooling=badsum
```

## üìÅ –ò–ó–ú–ï–ù–ï–ù–ù–´–ï –§–ê–ô–õ–´

### `recon/core/bypass/engine/windows_engine.py`
- **–î–æ–±–∞–≤–ª–µ–Ω–æ:** Zapret-—Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è –ª–æ–≥–∏–∫–∞ (—Å—Ç—Ä–æ–∫–∏ 1108-1130)
- **–î–æ–±–∞–≤–ª–µ–Ω–æ:** Zapret-style —Ñ—É–Ω–∫—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 2275-2470)
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** –û—Ç—Å—Ç—É–ø—ã –∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

### –ù–æ–≤—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
- `recon/test_zapret_fix.py` - –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- `recon/test_zapret_sequence.py` - –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- `recon/ZAPRET_PACKET_SEQUENCE_FIX.md` - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## ‚úÖ –°–¢–ê–¢–£–°: –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û

**üéØ –ì–õ–ê–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê:**
- Zapret-style –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞–∫–µ—Ç–æ–≤ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞–∫–µ—Ç–æ–≤ —É–º–µ–Ω—å—à–µ–Ω–æ —Å 5 –¥–æ 3
- –û–∂–∏–¥–∞–µ—Ç—Å—è –ø–æ–≤—ã—à–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ —Å 0% –¥–æ 15%+

**üöÄ –ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ –í –†–ï–ê–õ–¨–ù–´–• –£–°–õ–û–í–ò–Ø–•**

---

*–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ PCAP —Ñ–∞–π–ª–æ–≤ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å —Ä–∞–±–æ—Ç–∞—é—â–∏–º zapret.*